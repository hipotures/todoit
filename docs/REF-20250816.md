# TODOIT CLI Refactoring Reference - 2025-08-16

## Overview

Complete refactoring of TODOIT CLI interface with breaking changes. No backward compatibility provided.

## Key Changes

### 1. Terminology Update
- **OLD**: task/subtask terminology
- **NEW**: item/subitem terminology throughout

### 2. Command Structure
- **OLD**: Positional arguments: `todoit item add "list" "item" "content"`
- **NEW**: Explicit switches: `todoit item add --list "list" --item "item" --title "content"`

### 3. Parameter Names
- **OLD**: `content` parameter
- **NEW**: `--title` parameter (maps to content field internally)

### 4. Smart Command Logic
Commands automatically detect context based on provided parameters:
- Presence of `--subitem` parameter → operates on subitem
- Absence of `--subitem` parameter → operates on item

## Command Reference

### Item Add Command

**New Syntax:**
```bash
# Add item
todoit item add --list "project" --item "feature1" --title "Implement login system"

# Add subitem
todoit item add --list "project" --item "feature1" --subitem "step1" --title "Design login UI"
```

**OLD Commands Removed:**
- `todoit item add-subtask` - NO LONGER EXISTS

### Item Status Command

**New Syntax:**
```bash
# Update item status
todoit item status --list "project" --item "feature1" --status completed

# Update subitem status  
todoit item status --list "project" --item "feature1" --subitem "step1" --status completed
```

### Item Edit Command

**New Syntax:**
```bash
# Edit item
todoit item edit --list "project" --item "feature1" --title "Updated feature description"

# Edit subitem
todoit item edit --list "project" --item "feature1" --subitem "step1" --title "Updated step description"
```

### Item Delete Command

**New Syntax:**
```bash
# Delete item
todoit item delete --list "project" --item "feature1" --force

# Delete subitem
todoit item delete --list "project" --item "feature1" --subitem "step1" --force
```

### Item List Command

**New Syntax:**
```bash
# List all items in a list
todoit item list --list "project"

# List subitems of specific item
todoit item list --list "project" --item "feature1"
```

**OLD Commands Removed:**
- `todoit item subtasks` - NO LONGER EXISTS

### Other Commands

**Renamed Commands:**
- `move-to-subtask` → `move-to-subitem`

**Updated Commands:**
- `item tree` - Uses explicit switches
- `item next` - Uses explicit switches

## Manager API Changes

### Method Renames
- `add_subtask()` → `add_subitem()`
- `get_subtasks()` → `get_subitems()`
- All method names using "subtask" → "subitem"

### Parameter Changes
- Methods now accept `content` parameter but CLI maps `--title` to it

## Complete Example Workflow

```bash
# 1. Create project list
todoit list create --key "webapp" --title "Web Application Development"

# 2. Add main items
todoit item add --list "webapp" --item "backend" --title "Backend API development"
todoit item add --list "webapp" --item "frontend" --title "Frontend React application"
todoit item add --list "webapp" --item "deployment" --title "Production deployment setup"

# 3. Add subitems to backend
todoit item add --list "webapp" --item "backend" --subitem "database" --title "Setup PostgreSQL database"
todoit item add --list "webapp" --item "backend" --subitem "api" --title "Create REST API endpoints"
todoit item add --list "webapp" --item "backend" --subitem "auth" --title "Implement JWT authentication"

# 4. Add subitems to frontend
todoit item add --list "webapp" --item "frontend" --subitem "components" --title "Build React components"
todoit item add --list "webapp" --item "frontend" --subitem "routing" --title "Setup React Router"
todoit item add --list "webapp" --item "frontend" --subitem "state" --title "Implement Redux state management"

# 5. Update statuses
todoit item status --list "webapp" --item "backend" --subitem "database" --status completed
todoit item status --list "webapp" --item "backend" --subitem "api" --status in_progress
todoit item status --list "webapp" --item "frontend" --subitem "components" --status pending

# 6. View project structure
todoit item tree --list "webapp"

# 7. List subitems of specific item
todoit item list --list "webapp" --item "backend"

# 8. Edit item title
todoit item edit --list "webapp" --item "deployment" --title "AWS production deployment"

# 9. Move item to become subitem
todoit item move-to-subitem --list "webapp" --item "monitoring" --parent "deployment"

# 10. Delete completed subitem
todoit item delete --list "webapp" --item "backend" --subitem "database" --force
```

## Migration Notes

### NO BACKWARD COMPATIBILITY
- Old syntax will NOT work
- All scripts must be updated
- All documentation examples are updated

### Common Migration Patterns

**OLD → NEW:**
```bash
# Old positional syntax
todoit item add "project" "item1" "Some task"
# New explicit syntax
todoit item add --list "project" --item "item1" --title "Some task"

# Old subtask command
todoit item add-subtask "project" "item1" "step1" "Some step"
# New unified syntax
todoit item add --list "project" --item "item1" --subitem "step1" --title "Some step"

# Old status update
todoit item status "project" "item1" --status completed
# New explicit syntax
todoit item status --list "project" --item "item1" --status completed
```

## Implementation Details

### Files Modified
- `interfaces/cli_modules/item_commands.py` - Complete rewrite
- `core/manager.py` - Method renames and updates
- `docs/CLI_GUIDE.md` - Complete documentation update
- All test files - Updated to new syntax

### Database Schema
- NO database schema changes
- Field names remain the same (`content` field unchanged)
- Only CLI interface changes

### Internal Mapping
- CLI `--title` parameter maps to database `content` field
- All internal APIs remain compatible
- Only user-facing interface changes

## Benefits

1. **Explicit and Clear**: All parameters use descriptive switches
2. **Unified Interface**: Single commands handle both items and subitems
3. **Consistent Terminology**: item/subitem throughout
4. **Better Discoverability**: Clear parameter names
5. **Smart Context**: Commands adapt based on parameters provided
6. **No Ambiguity**: Explicit switches prevent confusion

## Breaking Changes Summary

⚠️ **BREAKING CHANGES - NO BACKWARD COMPATIBILITY**

1. All positional arguments removed - must use explicit switches
2. `content` parameter renamed to `--title`
3. Commands removed: `add-subtask`, `subtasks`
4. All "task/subtask" terminology changed to "item/subitem"
5. Manager API method names changed
6. All examples and documentation updated

Users must update all scripts and workflows to use the new syntax.